---
title: "Depth measurements cephalic furrow mutants"
author: "Bruno C. Vellutini"
date: "`r format(Sys.time(), '%d %B, %Y')`"
creation: May 31, 2021
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, tidy = TRUE, cache = FALSE)
knitr::opts_knit$set(root.dir = "~/Dropbox/Projects/Cephalic_furrow/7-Paper/1-analyses/fold-depth")
library(ggplot2)
```

## Load measurements

```{r load}
# Load raw ROI measurements from ImageJ
results <- read.delim("results.txt")

# Replace label by filename
results$Label <- sapply(strsplit(results$Label, ":"), "[", 1)

# Load sample info and merge with results
samples <- read.delim("samples.csv", sep = ",")
results <- merge(results, samples, by = "Label", all.x = TRUE)

# Print n btd embryos
length(samples[samples$Genotype == "heterozygote" & samples$Sample == "btd",]$Label)
length(samples[samples$Genotype == "homozygote" & samples$Sample == "btd",]$Label)

# Print n eve embryos
length(samples[samples$Genotype == "heterozygote" & samples$Sample == "eve",]$Label)
length(samples[samples$Genotype == "homozygote" & samples$Sample == "eve",]$Label)

# Print n btd folds
length(results[results$Genotype == "heterozygote" & results$Sample == "btd",]$Label)
length(results[results$Genotype == "homozygote" & results$Sample == "btd",]$Label)

# Print n eve folds
length(results[results$Genotype == "heterozygote" & results$Sample == "eve",]$Label)
length(results[results$Genotype == "homozygote" & results$Sample == "eve",]$Label)

```

```{r plot}

# Plot stocks separately
ggplot(results, aes(Genotype, Length, fill = Genotype)) +
  geom_violin(draw_quantiles = c("0.5"), show.legend = FALSE, alpha = 0.7) +
  geom_jitter(alpha = 0.8, width = 0.1, size = 2, show.legend = FALSE) +
  labs(x = "mutants", y = "depth") +
  facet_wrap(~Sample, strip.position = "top") +
  scale_color_manual(values=c("#56b4e9", "#e69f03")) +
  scale_fill_manual(values=c("#56b4e9", "#e69f03")) +
  theme_classic() +
  theme(text =  element_text(size = 30),
        strip.background = element_blank(),
        strip.placement = "outside",
        strip.text.x = element_text(face = "italic"),
        panel.background = element_rect(colour = "black", size=1))
ggsave("3-plots/depth_facet.png", width = 12, height = 6)
ggsave("3-plots/depth_facet.svg", width = 12, height = 6)

```


